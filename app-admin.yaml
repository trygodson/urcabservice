runtime: nodejs20
instance_class: F1
env: standard
service: admin-api

# Build configuration for admin_api
build_env_variables:
  BUILD_COMMAND: 'npm run build && npm run abuild && npm run astart'

# Environment variables
env_variables:
  NODE_ENV: production
  HTTP_PORT: 8080

  # JWT Configuration for Admin API
  JWT_ASECRET: your_admin_jwt_secret_here
  JWT_EXPIRATION: 3600

  # Database Configuration
  MONGODB_URI: your_mongodb_connection_string_here

  # PostgreSQL Configuration (if needed)
  PG_HOST: your_postgres_host
  PG_PORT: 5432
  PG_USERNAME: your_postgres_username
  PG_PASSWORD: your_postgres_password
  PG_DATABASE: your_postgres_database
  SYNCHRONIZE: false

  # Google OAuth Configuration
  G_CLIENTID: your_google_client_id
  G_CLIENTSECRET: your_google_client_secret

  # Firebase Configuration
  FIREBASE_PROJECT_ID: ondrtest-bb765
  FIREBASE_CLIENT_EMAIL: firebase-adminsdk-p2w1x@ondrtest-bb765.iam.gserviceaccount.com
  FIREBASE_PRIVATE_KEY: your_firebase_private_key_here

  # Redis Configuration (if using)
  REDIS_URL: your_redis_connection_string
  REDIS_HOST: your_redis_host
  REDIS_PORT: 6379

  # Other API URLs
  USER_API_URL: https://your-project-id.appspot.com
  DRIVER_API_URL: https://driver-api-dot-your-project-id.appspot.com

# Automatic scaling
automatic_scaling:
  min_instances: 0
  max_instances: 5
  target_cpu_utilization: 0.6

# Health check
readiness_check:
  path: '/health'
  check_interval_sec: 5
  timeout_sec: 4
  failure_threshold: 2
  success_threshold: 2

liveness_check:
  path: '/health'
  check_interval_sec: 30
  timeout_sec: 4
  failure_threshold: 4
  success_threshold: 2

# Skip files that don't need to be uploaded
skip_files:
  - ^(.*/)?#.*#$
  - ^(.*/)?.*~$
  - ^(.*/)?.*\.py[co]$
  - ^(.*/)?.*/RCS/.*$
  - ^(.*/)?\..*$
  - ^(.*/)?node_modules/.*$
  - ^(.*/)?coverage/.*$
  - ^(.*/)?\.nyc_output/.*$
  - ^(.*/)?dist/(?!apps/admin_api/).*$
